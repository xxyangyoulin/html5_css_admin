<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <title>admin</title>

    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.css">
    <link rel="stylesheet" href="css/admin.css">
</head>
<body>

<div id="main-page">
    <div id="sidebar" class="sidebar-open">
        <ul>
            <li>
                <div class="menu-item menu-head">
                    <span class="menu-icon fa fa-home"></span>
                    <span class="menu-title">后台管理系统</span>
                </div>
            </li>
            <li>
                <div class="menu-item">
                    <span class="menu-icon fa fa-envelope-open"></span>
                    <span class="menu-title">菜单一</span>
                    <span class="menu-ind fa fa-chevron-right"></span>
                </div>
                <ul class="sub-menu">
                    <li><a class="spec-menu-item" href="index.html#page1.html">子菜单一</a></li>
                    <li><a class="spec-menu-item" href="#">子菜单二</a></li>
                    <li><a class="spec-menu-item" href="#">子菜单三</a></li>
                </ul>
            </li>
            <li>
                <div class="menu-item">
                    <span class="menu-icon fa fa-shopping-cart"></span>
                    <span class="menu-title">菜单二</span>
                    <span class="menu-ind fa fa-chevron-right"></span>
                </div>
                <ul class="sub-menu">
                    <li><a class="spec-menu-item" href="#">子菜单一</a></li>
                    <li><a class="spec-menu-item" href="#">子菜单二</a></li>
                    <li><a class="spec-menu-item" href="#">子菜单三</a></li>
                </ul>
            </li>
            <li>
                <div class="menu-item">
                    <span class="menu-icon fa fa-search-minus"></span>
                    <span class="menu-title">菜单三</span>
                    <span class="menu-ind fa fa-chevron-right"></span>
                </div>
                <ul class="sub-menu">
                    <li><a class="spec-menu-item" href="#">子菜单一</a></li>
                    <li><a class="spec-menu-item" href="#">子菜单二</a></li>
                    <li><a class="spec-menu-item" href="#">子菜单三</a></li>
                </ul>
            </li>
            <li>
                <div class="menu-item">
                    <span class="menu-icon fa fa-cog"></span>
                    <span class="menu-title">菜单四</span>
                    <span class="menu-ind fa fa-chevron-right"></span>
                </div>
                <ul class="sub-menu">
                    <li><a class="spec-menu-item" href="#">子菜单一</a></li>
                    <li><a class="spec-menu-item" href="#">子菜单二</a></li>
                    <li><a class="spec-menu-item" href="#">子菜单三</a></li>
                </ul>
            </li>
        </ul>
    </div>

    <div class="section">
        <header id="header">
            <i id="menu-toggle" class="fa fa-bars hover-bg"></i>
            <div class="user-info hover-bg">
                <img src="img/pic.jpg" alt="头像"/>
                <span>张无忌</span>
            </div>
        </header>

        <div class="page">

        </div>
    </div>
</div>

<script src="js/jquery-2.2.4.min.js"></script>
<script src="js/jquery.hashchange.js"></script>
<script>


    function hide_sidebar() {
        var sidebar = $('#sidebar');
        if (sidebar.hasClass('sidebar-open')) {
            sidebar.removeClass('sidebar-open');
            sidebar.stop().animate({left: '-220px'});
            $('.section').stop().animate({marginLeft: "0"});
            $('#header').stop().animate({marginLeft: "0"});
            return true;
        }
        return false;
    }

    function show_sidebar() {
        var sidebar = $('#sidebar');
        if (!sidebar.hasClass('sidebar-open')) {
            sidebar.addClass('sidebar-open');
            sidebar.animate({left: '0px'});
            $('.section').stop().animate({marginLeft: sidebar.width()});
            $('#header').stop().animate({marginLeft: sidebar.width()});
            return true;
        }
        return false;
    }

    var is_user_close;

    function init_menu_toggle() {
        $('#menu-toggle').click(function () {
            if ($('#sidebar').hasClass('sidebar-open')) {
                hide_sidebar();
                is_user_close = true;
            } else {
                show_sidebar();
                is_user_close = false;
            }
        });
    }

    function init_mini_page() {
        $(".spec-menu-item").click(function () {
            var w = $(document).outerWidth();
            if (w < 992) {
                hide_sidebar();
            }
        });
    }

    function initSidebar() {
        var sidebar = $('#sidebar');
        var menu_item = sidebar.find('.menu-item');

        menu_item.on('click', function () {
            var $this = $(this);
            $this.next().slideToggle(250);
            $this.toggleClass('open');

            //关闭其他打开的菜单
            sidebar.find('.sub-menu').not($this.next()).slideUp().prev().removeClass('open');
        });

        sidebar.find('.open').next().show();

        init_menu_toggle();

        init_mini_page();
    }

    $(window).resize(function () {
        if (is_user_close) {
            return;
        }

        var w = $(document).outerWidth();
        if (w < 992) {
            hide_sidebar();
        } else {
            show_sidebar();
        }
    });

    $(function () {
        initSidebar();
    });

    $(function () {
        // Bind the event.
        $(window).hashchange(function () {
            if (!location.hash || location.hash == "") {
                initMainPage();
                return;
            }

            //use jquery ajax err, so..
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function () {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    $(".page").html(xhr.responseText);
                }
            };
            var action = location.hash.replace('#', "");
            console.log(action);
            xhr.open("get", action);
            xhr.send();
        });

        $(window).trigger("hashchange");
    });

    function initMainPage() {
        window.location = "index.html#table.html";
    }
</script>
</body>
</html>